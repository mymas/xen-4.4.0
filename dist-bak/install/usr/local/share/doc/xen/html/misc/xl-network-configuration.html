<h1>XL Network Configuration</h1>

<h2>Syntax Overview</h2>

<p>This document specifies the xl config file format vif configuration
option.  It has the following form:</p>

<pre><code>    vif = [ '&lt;vifspec&gt;', '&lt;vifspec&gt;', ... ]
</code></pre>

<p>where each vifspec is in this form:</p>

<pre><code>    [&lt;key&gt;=&lt;value&gt;|&lt;flag&gt;,]
</code></pre>

<p>For example:</p>

<pre><code>    'mac=00:16:3E:74:3d:76,model=rtl8139,bridge=xenbr0'
    'mac=00:16:3E:74:34:32'
    '' # The empty string
</code></pre>

<p>These might be specified in the domain config file like this:</p>

<pre><code>    vif = [ 'mac=00:16:3E:74:34:32', 'mac=00:16:3e:5f:48:e4,bridge=xenbr1' ]
</code></pre>

<p>More formally, the string is a series of comma-separated keyword/value
pairs. All keywords are optional.</p>

<p>Each device has a <code>DEVID</code> which is its index within the vif list, starting from 0.</p>

<h2>Keywords</h2>

<h3>mac</h3>

<p>If specified then this option specifies the MAC address inside the
guest of this VIF device. The value is a 48-bit number represented as
six groups of two hexadecimal digits, separated by colons (:).</p>

<p>The default if this keyword is not specified is to be automatically
generate a MAC address inside the space assigned to Xen's
<a href="http://en.wikipedia.org/wiki/Organizationally_Unique_Identifier">Organizationally Unique Identifier</a> (00:16:3e).</p>

<p>If you are choosing a MAC address then it is strongly recommend to
follow one of the following strategies:</p>

<ul>
<li>Generate a random sequence of 6 byte, set the locally administered
bit (bit 2 of the first byte) and clear the multicast bit (bit 1
of the first byte). In other words the first byte should have the
bit pattern xxxxxx10 (where x is a randomly generated bit) and the
remaining 5 bytes are randomly generated See
[http://en.wikipedia.org/wiki/MAC_address] for more details the
structure of a MAC address.</li>
<li>Allocate an address from within the space defined by your
organization's OUI (if you have one) following your organization's
procedures for doing so.</li>
<li>Allocate an address from within the space defined by Xen's OUI
(00:16:3e). Taking care not to clash with other users of the
physical network segment where this VIF will reside.</li>
</ul>

<p>If you have an OUI for your own use then that is the preferred
strategy. Otherwise in general you should prefer to generate a random
MAC and set the locally administered bit since this allows for more
bits of randomness than using the Xen OUI.</p>

<h3>bridge</h3>

<p>Specifies the name of the network bridge which this VIF should be
added to. The default is <code>xenbr0</code>. The bridge must be configured using
your distribution's network configuration tools. See the <a href="http://wiki.xen.org/wiki/HostConfiguration/Networking">wiki</a>
for guidance and examples.</p>

<h3>gatewaydev</h3>

<p>Specifies the name of the network interface which has an IP and which
is in the network the VIF should communicate with. This is used in the host
by the vif-route hotplug script. See <a href="http://wiki.xen.org/wiki/Vif-route">wiki</a> for guidance and
examples.</p>

<p>NOTE: netdev is a deprecated alias of this option.</p>

<h3>type</h3>

<p>This keyword is valid for HVM guests only.</p>

<p>Specifies the type of device to valid values are:</p>

<ul>
<li><code>ioemu</code> (default) -- this device will be provided as an emulate
device to the guest and also as a paravirtualised device which the
guest may choose to use instead if it has suitable drivers
available.</li>
<li><code>vif</code> -- this device will be provided as a paravirtualised device
only.</li>
</ul>

<h3>model</h3>

<p>This keyword is valid for HVM guest devices with <code>type=ioemu</code> only.</p>

<p>Specifies the type device to emulated for this guest. Valid values
are:</p>

<ul>
<li><code>rtl8139</code> (default) -- Realtek RTL8139</li>
<li><code>e1000</code> -- Intel E1000 </li>
<li>in principle any device supported by your device model</li>
</ul>

<h3>vifname</h3>

<p>Specifies the backend device name for the virtual device.</p>

<p>If the domain is an HVM domain then the associated emulated (tap)
device will have a "-emu" suffice added.</p>

<p>The default name for the virtual device is <code>vifDOMID.DEVID</code> where
<code>DOMID</code> is the guest domain ID and <code>DEVID</code> is the device
number. Likewise the default tap name is <code>vifDOMID.DEVID-emu</code>.</p>

<h3>script</h3>

<p>Specifies the hotplug script to run to configure this device (e.g. to
add it to the relevant bridge). Defaults to
<code>XEN_SCRIPT_DIR/vif-bridge</code> but can be set to any script. Some example
scripts are installed in <code>XEN_SCRIPT_DIR</code>.</p>

<h3>ip</h3>

<p>Specifies the IP address for the device, the default is not to
specify an IP address.</p>

<p>What, if any, effect this has depends on the hotplug script which is
configured. A typically behaviour (exhibited by the example hotplug
scripts) if set might be to configure firewall rules to allow only the
specified IP address to be used by the guest (blocking all others).</p>

<h3>backend</h3>

<p>Specifies the backend domain which this device should attach to. This
defaults to domain 0.  Specifying another domain requires setting up a
driver domain which is outside the scope of this document.</p>

<h3>rate</h3>

<p>Specifies the rate at which the outgoing traffic will be limited to.
The default if this keyword is not specified is unlimited.</p>

<p>The rate may be specified as "<RATE>/s" or optionally "<RATE>/s@<INTERVAL>".</p>

<ul>
<li><code>RATE</code> is in bytes and can accept suffixes:
<ul>
<li>GB, MB, KB, B for bytes.</li>
<li>Gb, Mb, Kb, b for bits.</li>
</ul></li>
<li><code>INTERVAL</code> is in microseconds and can accept suffixes: ms, us, s.
It determines the frequency at which the vif transmission credit
is replenished. The default is 50ms.</li>
</ul>

<p>Vif rate limiting is credit-based. It means that for "1MB/s@20ms", the
available credit will be equivalent of the traffic you would have done
at "1MB/s" during 20ms. This will results in a credit of 20,000 bytes
replenished every 20,000 us.</p>

<p>For example:</p>

<pre><code>    'rate=10Mb/s' -- meaning up to 10 megabits every second
    'rate=250KB/s' -- meaning up to 250 kilobytes every second
    'rate=1MB/s@20ms' -- meaning 20,000 bytes in every 20 millisecond period
</code></pre>

<p>NOTE: The actual underlying limits of rate limiting are dependent
on the underlying netback implementation.</p>
